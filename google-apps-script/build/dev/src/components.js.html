(function () {
    'use strict';
    
    angular.module('spread2TS')
        .component('spreadMap', {
            templateUrl: 'spread-map.html',
            controller: 'spreadMapController'
        });
})();
(function () {
  'use strict';
  console.log(' spreadMapController');
  angular.module('spread2TS')
      .controller('spreadMapController', function ($scope,tableMapService) {
        var sm = this;

        tableMapService.getTable('1iVYS6XMviFJPkZqNqQ-mcujExUA66X0c9apvkhQ3')
            .subscribe(function (table) {
                $scope.columns = table.columns.map(function (c) {

                    c.MapName = c.name;
                    c.Append = true;

                    return c;
                });

                $scope.$applyAsync();
        });

        $scope.vMM = "Otro vez! JAV";
      });
})();

(function () {
  'use strict';

  angular.module('spread2TS')
    .factory('spreadMapService', function () {

      return {
        getColumnsFromSpread: function (spreadId) {

          return Rx.Observable.create(function (observer){
            // Yield a single value and complete
            var retFromSvr = function (data) {
              observer.onNext(data);
              observer.onCompleted();
            };

            google.script.run
              .withSuccessHandler(retFromSvr)
              .getSpreadColumns(spreadId);

            return function () {
                console.log('disposed');
            };
          });
        }
      };
    });

})();
(function () {
    'use strict';

    angular.module('spread2TS')
        .factory('tableMapService', function () {

            return {
                getTable: function (tableId) {

                    return Rx.Observable.create(function (observer) {
                        // Yield a single value and complete
                        var retFromSvr = function (data) {

                            observer.onNext(data);
                            observer.onCompleted();
                        };

                        google.script.run
                            .withSuccessHandler(retFromSvr)
                            .getTable(tableId);

                        return function () {
                            console.log('disposed');
                        };
                    });
                }
            };
        });

})();
(function () {
    'use strict';

    angular.module('spread2TS')
        .factory('typescriptBuilderService', function () {

            return {
                getTypes: ['boolean', 'number', 'string', 'Date']
            };
        });

})();